(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{100:function(e,t,a){},101:function(e,t,a){},120:function(e,t,a){},125:function(e,t,a){},155:function(e,t){},158:function(e,t,a){},159:function(e,t,a){},160:function(e,t,a){},161:function(e,t,a){},162:function(e,t,a){},163:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(21),o=a.n(c),l=(a(100),a(101),a(10)),i=a.n(l),s=a(7),m=a(103),u="/api/conversations",E=function(){var e;return i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.awrap(m.get(u));case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}))},d=function(e){var t;return i.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i.a.awrap(m.post(u,e));case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}))},f=a(16),p=a(17),g=(a(120),function(e){var t=e.conversation;return r.a.createElement(r.a.Fragment,null,r.a.createElement(p.b,{to:"/conversations/"+t.id},r.a.createElement(f.a,{className:"card bg-dark text-white conversation-item"},r.a.createElement(f.a.Img,{src:t.image,className:"image",alt:"Card image"}),r.a.createElement(f.a.Header,null,t.title))))}),v=a(92),b=function(){return r.a.createElement(v.a,{className:"spinner",animation:"border",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))},h=(a(125),function(){var e=Object(n.useState)(),t=Object(s.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(),l=Object(s.a)(o,2),m=(l[0],l[1]);return Object(n.useEffect)((function(){!function(){var e;i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.awrap(E());case 2:e=t.sent,c(e),m(Array.from(e).sort((function(e,t){return t.messages.length-e.messages.length})).slice(0,10));case 5:case"end":return t.stop()}}))}()}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",{className:"list-header"},"All Conversations"),r.a.createElement("div",{className:"conversation-list"},a?r.a.createElement(r.a.Fragment,null,a.map((function(e){return r.a.createElement(g,{key:e.id,conversation:e})}))):r.a.createElement(b,null)))}),O=a(36),w=a(22),j=a(49),x=a(9),y=a(26),N=function(){var e=Object(n.useState)(!0),t=Object(s.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(""),l=Object(s.a)(o,2),m=l[0],u=l[1],E=Object(n.useState)(""),f=Object(s.a)(E,2),p=f[0],g=f[1],v=Object(n.useState)(!1),h=Object(s.a)(v,2),N=h[0],C=h[1],S=Object(n.useState)(),T=Object(s.a)(S,2),k=T[0],F=T[1],L=Object(n.useState)(),R=Object(s.a)(L,2),A=R[0],I=R[1],B=Object(n.useState)(""),D=Object(s.a)(B,2),H=D[0],G=D[1],M=Object(y.e)(),P=function(e){var t,a;return i.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.preventDefault(),C(!0),!(p&&H&&A)){n.next=13;break}return(t={}).title=p,t.description=H,t.image=k,n.next=9,i.a.awrap(d(t));case 9:a=n.sent,M.push("/conversations/"+a.id),n.next=15;break;case 13:C(!1),u("The conversation needs a title, a description and an image.");case 15:case"end":return n.stop()}}))},_=function(){c(!1),M.goBack()},z=function(e,t){I(e),console.log("Accepted File",e),F(t),u()},J=function(e){I(),F(),u(e)},U=function(e,t,a){var n=new Image;n.onload=function(){t.size<5242880?a(!0,""):a(!1,"File is too large.")},n.onerror=function(){return a(!1,"File is not an image.")},n.src=e};return r.a.createElement(r.a.Fragment,null,r.a.createElement(O.a,{show:a,onHide:_,animation:!1},r.a.createElement(O.a.Header,{closeButton:!0},r.a.createElement(O.a.Title,null,"Create a new conversation")),N?r.a.createElement(r.a.Fragment,null,r.a.createElement(b,null)):r.a.createElement(r.a.Fragment,null,r.a.createElement(O.a.Body,null,m&&r.a.createElement(j.a,{className:"alert alert-danger"},m),r.a.createElement("div",{className:"postForm"},r.a.createElement(x.a,{onSubmit:P},r.a.createElement(x.a.Group,null,r.a.createElement(x.a.Label,{htmlFor:"title"},"Title for the Conversation: "),r.a.createElement(x.a.Control,{type:"text",name:"title",onChange:function(e){return g(e.target.value)}})),r.a.createElement(x.a.Group,null,r.a.createElement(x.a.Label,{htmlFor:"description"},"Description of the Conversation: "),r.a.createElement(x.a.Control,{type:"text",name:"title",onChange:function(e){return G(e.target.value)}})),r.a.createElement(x.a.Group,null,r.a.createElement(x.a.Label,{htmlFor:"image"},"Image for the Conversation: "),r.a.createElement(x.a.Control,{type:"file",name:"image",accept:"image/*",onChange:function(e){var t,a;return i.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:F(),t=e.target.files[0],(a=new FileReader).onloadend=function(){U(a.result,t,(function(e,n){e?z(t,a.result):J(n)}))},a.readAsDataURL(t);case 5:case"end":return n.stop()}}))}}),r.a.createElement(x.a.Text,null," Image size limit is 5mb ")))),k&&r.a.createElement("div",{style:{textAlign:"center"}}," Preview: ",r.a.createElement("div",null,r.a.createElement("img",{src:k,style:{maxHeight:"300px"},alt:"Preview goes here"})))),r.a.createElement(O.a.Footer,null,r.a.createElement(w.a,{variant:"secondary",onClick:_},"Close"),r.a.createElement(w.a,{variant:"primary",onClick:P},"Save Changes")))))},C=a(93),S=a.n(C),T=a(94),k=(a(158),function(e){var t=e.conversation,a=e.goToTop,n=e.goToLast,c=e.width;return r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{className:"card bg-light text-dark sidebar-item",style:{position:c>720?"sticky":"static",left:"1em",top:"6em",width:c>720?"360px":.9*c+"px",margin:"1em",height:"100%"}},r.a.createElement(f.a.Img,{src:t.image,className:"sidebar-image",alt:"Card image"}),r.a.createElement(f.a.Header,{className:"sidebar-header"},t.title),r.a.createElement(f.a.Text,{className:"sidebar-description"},t.description),r.a.createElement(w.a,{variant:"outline-primary",onClick:a},"Go to top"),r.a.createElement(w.a,{variant:"outline-primary",onClick:n},"Go to the newest message")))}),F=a(63),L=a(39),R=a(50),A=function(e){var t,a=e.setError,c=e.goToLast,o=e.propsId,l=e.socket,i=Object(n.useState)(""),m=Object(s.a)(i,2),u=m[0],E=m[1],d=Object(n.useState)(o),p=Object(s.a)(d,1)[0],g=Object(n.useState)(""),v=Object(s.a)(g,2),b=v[0],h=v[1],O=function(e){e.preventDefault();var t=b.trim(),a=u.trim();j(t,a)?y(t,a):N()},j=function(e,t){return e&&t},y=function(e,t){l.emit("POST_COMMENT",p,{text:e,name:t,date:Date.now()}),h(""),a(""),c()},N=function(){a("Neither the comment or the username can be empty")};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",(t={className:"col"},Object(F.a)(t,"className","col"),Object(F.a)(t,"style",{background:"white",position:"fixed",bottom:0,width:"100%"}),t),r.a.createElement(f.a,{style:{background:"white",padding:10,position:"fixed",bottom:0,left:0,right:0,width:"100%"}},r.a.createElement(x.a,{onSubmit:function(e){return O(e)},className:"comment-form"},r.a.createElement(x.a.Row,null,r.a.createElement(x.a.Group,{as:L.a,sm:"3",style:{marginLeft:"auto",marginRight:"auto"}},r.a.createElement(x.a.Label,null,"Your Name"),r.a.createElement(R.a,null,r.a.createElement(R.a.Prepend,null,r.a.createElement(R.a.Text,null,"@")),r.a.createElement(x.a.Control,{type:"text",placeholder:"Username",value:u,onChange:function(e){return E(e.target.value)},required:!0}))),r.a.createElement(x.a.Group,{as:L.a,sm:"8",style:{marginLeft:"auto",marginRight:"auto"}},r.a.createElement(x.a.Label,null,"Your Comment"),r.a.createElement(x.a.Control,{as:"textarea",type:"text",value:b,onChange:function(e){return h(e.target.value)},required:!0,onKeyPress:function(e){"Enter"===e.key&&O(e)}}),r.a.createElement(w.a,{type:"submit"},"Send comment"))))))))},I=a(52),B=(a(159),function(e){var t=e.message,a=e.width,n=new Date(t.date),c=n.getFullYear(),o=n.getMonth(),l=n.getDate(),i=n.getHours(),s=n.getMinutes();return s=1===s.toString().length?"0"+s.toString():s,r.a.createElement(I.a,{className:"message",style:{width:a>720?.8*(a-480)+"px":"90%",maxWidth:a>720?.8*(a-480)+"px":"90%"}},r.a.createElement(I.a.Header,{closeButton:!1},r.a.createElement("strong",{className:"mr-auto"},t.name),r.a.createElement("small",null,l+"/"+o+"/"+c+" "+i+":"+s)),r.a.createElement(I.a.Body,null,t.text))}),D=(a(160),function(e){var t=e.messages,a=e.width;return r.a.createElement(r.a.Fragment,null,t.map((function(e,t){return r.a.createElement(B,{key:t,message:e,width:a})})))});function H(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}a(161);var G=function(e){var t=Object(n.useState)({}),a=Object(s.a)(t,2),c=a[0],o=a[1],l=Object(T.a)([]),i=Object(s.a)(l,2),m=i[0],u=i[1],E=Object(n.useState)(e.match.params.id),d=Object(s.a)(E,1)[0],f=Object(n.useState)(""),p=Object(s.a)(f,2),g=p[0],v=p[1],b=Object(n.useState)(null),h=Object(s.a)(b,2),O=h[0],w=h[1],x=function(){var e=Object(n.useState)(H()),t=Object(s.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){function e(){r(H())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),a}(),y=x.height,N=x.width,C=Object(n.useRef)(null),F=Object(n.useRef)(null);Object(n.useEffect)((function(){var e;return O||((e=S()("https://roninchatapp.herokuapp.com/")).connect(),e.emit("JOIN_ROOM",d),e.on("SET_CONVERSATION",(function(e){o(e),u((function(t){e.messages.map((function(e){return t.push(e)}))}))})),e.on("UPDATE_CONVERSATION",(function(e){u((function(t){t.push(e)}))})),e.on("SET_ERROR",(function(e){v(e)})),w(e)),function(){e.emit("LEAVE_ROOM",d),e.disconnect()}}),[]);var L=function(e){return window.scrollTo(0,e.current.offsetTop)},R=function(){return L(C)};return r.a.createElement(r.a.Fragment,null,g&&r.a.createElement(j.a,{variant:"danger",className:"conversation-view-error"},g),r.a.createElement("div",{className:"conversation-view"},r.a.createElement("div",{className:"sidebar-and-messages"},r.a.createElement(k,{conversation:c,goToTop:function(){return L(F)},goToLast:R,width:N}),r.a.createElement("div",{className:"messages",style:{marginBottom:N>720?y/4+"px":y/3+"px"}},r.a.createElement("div",{ref:F,className:"invisible"}),r.a.createElement(D,{messages:m,width:N}),r.a.createElement("div",{ref:C,className:"invisible"}))),r.a.createElement(A,{setError:v,goToLast:R,propsId:d,socket:O})))},M=a(51),P=a(40),_=(a(162),function(){return r.a.createElement(P.a,{className:"menu",collapseOnSelect:!0,bg:"light",expand:"lg"},r.a.createElement(P.a.Brand,{as:p.b,href:"#",to:"/"},"Ronin ChatApp"),r.a.createElement(P.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(P.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(M.a,{className:"mr-auto"},r.a.createElement(M.a.Link,{as:p.b,href:"#","data-testid":"restaurantList-link",to:"/"},"Conversation list"),r.a.createElement(M.a.Link,{as:p.b,href:"#",to:"/newconversation"},"Create a new conversation"))))}),z=function(){return r.a.createElement("div",{id:"AppWrapper",className:"App"},r.a.createElement(_,null),r.a.createElement(y.a,{exact:!0,path:"/",component:h}),r.a.createElement(y.a,{exact:!0,path:"/newConversation",component:N}),r.a.createElement(y.a,{exact:!0,path:"/conversations/:id",component:G}))};o.a.render(r.a.createElement(p.a,null,r.a.createElement(z,null)),document.getElementById("root"))},95:function(e,t,a){e.exports=a(163)}},[[95,1,2]]]);
//# sourceMappingURL=main.73efdb2a.chunk.js.map