(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{100:function(e,t,a){},101:function(e,t,a){},120:function(e,t,a){},154:function(e,t){},157:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(20),l=a.n(c),o=(a(100),a(101),a(10)),i=a.n(o),s=a(7),u=a(103),m="/api/conversations",E=function(){var e;return i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.awrap(u.get(m));case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}))},f=function(e){var t;return i.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i.a.awrap(u.post(m,e));case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}))},d=a(16),p=(a(120),function(e){var t=e.conversation;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"all"},r.a.createElement("div",{className:"view view-first"},r.a.createElement(d.b,{to:"/conversations/"+t.id},r.a.createElement("img",{src:t.image,alt:"Conversation image"}),r.a.createElement("div",{className:"mask"},r.a.createElement("h2",null,t.title),r.a.createElement("p",null,t.description),r.a.createElement("p",{className:"info"},"Join"))))))}),g=a(90),v=function(){return r.a.createElement(g.a,{animation:"border",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))},b=function(){var e=Object(n.useState)(),t=Object(s.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)([]),o=Object(s.a)(l,2),u=(o[0],o[1]);return Object(n.useEffect)((function(){!function(){var e;i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.awrap(E());case 2:e=t.sent,c(e),u(Array.from(e).sort((function(e,t){return t.messages.length-e.messages.length})).slice(0,10));case 5:case"end":return t.stop()}}))}()}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row",style:{width:"100%",textAlign:"center"}},r.a.createElement("div",{className:"col-sm"},r.a.createElement("h2",{style:{margin:"30px"}},"All Conversations"),a?r.a.createElement("div",null,a.map((function(e){return r.a.createElement(p,{key:e.id,conversation:e})}))):r.a.createElement(v,null)))))},h=a(35),O=a(24),w=a(47),j=a(9),y=a(25),x=function(){var e=Object(n.useState)(!0),t=Object(s.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(""),o=Object(s.a)(l,2),u=o[0],m=o[1],E=Object(n.useState)(""),d=Object(s.a)(E,2),p=d[0],g=d[1],b=Object(n.useState)(!1),x=Object(s.a)(b,2),C=x[0],S=x[1],N=Object(n.useState)(),k=Object(s.a)(N,2),F=k[0],T=k[1],L=Object(n.useState)(),A=Object(s.a)(L,2),R=A[0],I=A[1],D=Object(n.useState)(""),B=Object(s.a)(D,2),G=B[0],H=B[1],M=Object(y.e)(),_=function(e){var t,a;return i.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.preventDefault(),S(!0),!(p&&G&&R)){n.next=13;break}return(t={}).title=p,t.description=G,t.image=F,n.next=9,i.a.awrap(f(t));case 9:a=n.sent,M.push("/conversations/"+a.id),n.next=15;break;case 13:S(!1),m("The conversation needs a title, a description and an image.");case 15:case"end":return n.stop()}}))},P=function(){c(!1),M.goBack()},z=function(e,t){I(e),console.log("Accepted File",e),T(t),m()},J=function(e){I(),T(),m(e)},U=function(e,t,a){var n=new Image;n.onload=function(){t.size<5242880?a(!0,""):a(!1,"File is too large.")},n.onerror=function(){return a(!1,"File is not an image.")},n.src=e};return r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{show:a,onHide:P,animation:!1},r.a.createElement(h.a.Header,{closeButton:!0},r.a.createElement(h.a.Title,null,"Create a new conversation")),C?r.a.createElement(r.a.Fragment,null,r.a.createElement(v,null)):r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a.Body,null,u&&r.a.createElement(w.a,{className:"alert alert-danger"},u),r.a.createElement("div",{className:"postForm"},r.a.createElement(j.a,{onSubmit:_},r.a.createElement(j.a.Group,null,r.a.createElement(j.a.Label,{htmlFor:"title"},"Title for the Conversation: "),r.a.createElement(j.a.Control,{type:"text",name:"title",onChange:function(e){return g(e.target.value)}})),r.a.createElement(j.a.Group,null,r.a.createElement(j.a.Label,{htmlFor:"description"},"Description of the Conversation: "),r.a.createElement(j.a.Control,{type:"text",name:"title",onChange:function(e){return H(e.target.value)}})),r.a.createElement(j.a.Group,null,r.a.createElement(j.a.Label,{htmlFor:"image"},"Image for the Conversation: "),r.a.createElement(j.a.Control,{type:"file",name:"image",accept:"image/*",onChange:function(e){var t,a;return i.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:T(),t=e.target.files[0],(a=new FileReader).onloadend=function(){U(a.result,t,(function(e,n){e?z(t,a.result):J(n)}))},a.readAsDataURL(t);case 5:case"end":return n.stop()}}))}}),r.a.createElement(j.a.Text,null," Image size limit is 5mb ")))),F&&r.a.createElement("div",{style:{textAlign:"center"}}," Preview: ",r.a.createElement("div",null,r.a.createElement("img",{src:F,style:{maxHeight:"300px"},alt:"Preview goes here"})))),r.a.createElement(h.a.Footer,null,r.a.createElement(O.a,{variant:"secondary",onClick:P},"Close"),r.a.createElement(O.a,{variant:"primary",onClick:_},"Save Changes")))))},C=a(92),S=a.n(C),N=a(93),k=a(62),F=a(38),T=a(94),L=a(49),A=function(e){var t,a=e.setError,c=e.goToLast,l=e.propsId,o=e.socket,i=Object(n.useState)(""),u=Object(s.a)(i,2),m=u[0],E=u[1],f=Object(n.useState)(l),d=Object(s.a)(f,1)[0],p=Object(n.useState)(""),g=Object(s.a)(p,2),v=g[0],b=g[1],h=function(){return m&&v},w=function(){o.emit("POST_COMMENT",d,{name:m,text:v,date:Date.now()}),b(""),a(""),c()},y=function(){a("Comment can't be empty")};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",(t={className:"col"},Object(k.a)(t,"className","col"),Object(k.a)(t,"style",{background:"white",position:"fixed",bottom:0,width:"100%"}),t),r.a.createElement(T.a,{style:{background:"white",padding:10,position:"fixed",bottom:0,left:0,right:0,width:"100%"}},r.a.createElement(j.a,{onSubmit:function(e){return function(e){e.preventDefault(),h()?w():y()}(e)},className:"comment-form"},r.a.createElement(j.a.Row,null,r.a.createElement(j.a.Group,{as:F.a,sm:"3",style:{marginLeft:"auto",marginRight:"auto"}},r.a.createElement(j.a.Label,null,"Your Name"),r.a.createElement(L.a,null,r.a.createElement(L.a.Prepend,null,r.a.createElement(L.a.Text,null,"@")),r.a.createElement(j.a.Control,{type:"text",placeholder:"Username",value:m,onChange:function(e){return E(e.target.value)},required:!0}))),r.a.createElement(j.a.Group,{as:F.a,sm:"8",style:{marginLeft:"auto",marginRight:"auto"}},r.a.createElement(j.a.Label,null,"Your Comment"),r.a.createElement(j.a.Control,{as:"textarea",type:"text",value:v,onChange:function(e){return b(e.target.value)}}),r.a.createElement(O.a,{type:"submit"},"Send comment"))))))))},R=a(51),I=function(e){var t=e.message,a=new Date(t.date),n=a.getFullYear(),c=a.getMonth(),l=a.getDate(),o=a.getHours(),i=a.getMinutes();return i=1===i.toString().length?"0"+i.toString():i,r.a.createElement(R.a,{style:{margin:"auto",marginTop:10}},r.a.createElement(R.a.Header,{closeButton:!1},r.a.createElement("strong",{className:"mr-auto"},t.name),r.a.createElement("small",null,l+"/"+c+"/"+n+" "+o+":"+i)),r.a.createElement(R.a.Body,null,t.text))},D=function(e){var t=e.messages;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{position:"sticky",padding:10}},t.map((function(e,t){return r.a.createElement(I,{key:t,message:e})}))))};function B(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}var G=function(e){var t=Object(n.useState)({}),a=Object(s.a)(t,2),c=a[0],l=a[1],o=Object(N.a)([]),i=Object(s.a)(o,2),u=i[0],m=i[1],E=Object(n.useState)(e.match.params.id),f=Object(s.a)(E,1)[0],d=Object(n.useState)(""),p=Object(s.a)(d,2),g=p[0],b=p[1],h=Object(n.useState)(null),j=Object(s.a)(h,2),y=j[0],x=j[1],C=function(){var e=Object(n.useState)(B()),t=Object(s.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){function e(){r(B())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),a}(),k=C.height,F=(C.width,Object(n.useRef)(null)),T=Object(n.useRef)(null);Object(n.useEffect)((function(){var e;return y||((e=S()("https://roninchatapp.herokuapp.com/")).connect(),e.emit("JOIN_ROOM",f),e.on("SET_CONVERSATION",(function(e){l(e),m((function(t){e.messages.map((function(e){return t.push(e)}))}))})),e.on("UPDATE_CONVERSATION",(function(e){m((function(t){t.push(e)}))})),e.on("SET_ERROR",(function(e){b(e)})),x(e)),function(){e.emit("LEAVE_ROOM",f),e.disconnect()}}),[]);var L=function(e){return window.scrollTo(0,e.current.offsetTop)},R=function(){return L(F)};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"container",style:{textAlign:"left"}},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col",style:{width:"100%"}},r.a.createElement("h2",{style:{width:"100%",margin:"30px",textAlign:"center"}},c.title),r.a.createElement(O.a,{onClick:R},"Go to last"),g?r.a.createElement(w.a,{variant:"danger",style:{position:"fixed",top:0,left:0,right:0}},g):null,r.a.createElement("div",{ref:T,style:{visibility:"hidden",height:"1px",float:"left",clear:"both"}}),u?r.a.createElement(D,{messages:u}):r.a.createElement(v,null),r.a.createElement("div",{ref:F,style:{visibility:"hidden",height:"1px",float:"left",clear:"both"}}),r.a.createElement(O.a,{onClick:function(){return L(T)}},"Go to top")))),r.a.createElement("div",{className:"container",style:{maxHeight:k/3.5,height:k/3.5}},r.a.createElement(A,{setError:b,goToLast:R,propsId:f,socket:y})))},H=a(50),M=a(39),_=function(){return r.a.createElement(M.a,{collapseOnSelect:!0,bg:"light",expand:"lg"},r.a.createElement(M.a.Brand,{as:d.b,href:"#",to:"/"},"Ronin ChatApp"),r.a.createElement(M.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(M.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(H.a,{className:"mr-auto"},r.a.createElement(H.a.Link,{as:d.b,href:"#","data-testid":"restaurantList-link",to:"/"},"Conversation list"),r.a.createElement(H.a.Link,{as:d.b,href:"#",to:"/newconversation"},"Create a new conversation"))))},P=function(){return r.a.createElement("div",{id:"AppWrapper",className:"App"},r.a.createElement(_,null),r.a.createElement(y.a,{exact:!0,path:"/",component:b}),r.a.createElement(y.a,{exact:!0,path:"/newConversation",component:x}),r.a.createElement(y.a,{exact:!0,path:"/conversations/:id",component:G}))};l.a.render(r.a.createElement(d.a,null,r.a.createElement(P,null)),document.getElementById("root"))},95:function(e,t,a){e.exports=a(157)}},[[95,1,2]]]);
//# sourceMappingURL=main.ef3f8fe0.chunk.js.map