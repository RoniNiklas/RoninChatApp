(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{102:function(e,t,a){},103:function(e,t,a){},122:function(e,t,a){},156:function(e,t){},159:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(20),c=a.n(l),o=(a(102),a(103),a(11)),i=a.n(o),s=a(8),u=a(105),m="/api/conversations",E=function(){var e;return i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(m),t.next=3,i.a.awrap(u.get(m));case 3:return e=t.sent,console.log(e),t.abrupt("return",e.data);case 6:case"end":return t.stop()}}))},d=function(e){var t;return i.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return console.log(e),a.next=3,i.a.awrap(u.post(m,e));case 3:return t=a.sent,console.log(t.data),a.abrupt("return",t.data);case 6:case"end":return a.stop()}}))},f=a(16),g=(a(122),function(e){var t=e.conversation;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"all"},r.a.createElement("div",{className:"view view-first"},r.a.createElement(f.b,{to:"/conversations/"+t.id},r.a.createElement("img",{src:t.image}),r.a.createElement("div",{className:"mask"},r.a.createElement("h2",null,t.title),r.a.createElement("p",null,t.description),r.a.createElement("a",{className:"info"},"Join"))))))}),p=a(91),v=function(){return r.a.createElement(p.a,{animation:"border",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))},h=a(52),b=a(93),O=function(e){var t=e.conversations;return r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,null,t.map((function(e){return r.a.createElement(h.a.Item,{key:e.id,style:{textAlign:"center",width:"100%",height:"360px",background:"gray"}},r.a.createElement("div",null,r.a.createElement(b.a,{fluid:!0,style:{maxWidth:"100%",maxHeight:"100%"},src:e.image,alt:"First slide"})),r.a.createElement(h.a.Caption,null,r.a.createElement("h3",null,e.title),r.a.createElement("p",null,e.description)))}))))},w=function(){var e=Object(n.useState)([]),t=Object(s.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)([]),o=Object(s.a)(c,2),u=o[0],m=o[1],d=Object(n.useState)(!0),f=Object(s.a)(d,2),p=f[0],h=f[1];return Object(n.useEffect)((function(){!function(){var e;i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return h(!0),t.next=3,i.a.awrap(E());case 3:e=t.sent,l(e),m(Array.from(e).sort((function(e,t){return t.messages.length-e.messages.length})).slice(0,10)),h(!1);case 7:case"end":return t.stop()}}))}()}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row",style:{width:"100%",textAlign:"center"}},r.a.createElement("div",{className:"col-sm"},r.a.createElement("h2",null,"Popular Conversations"),p?r.a.createElement(v,null):r.a.createElement("div",null,r.a.createElement(O,{conversations:u})))),r.a.createElement("div",{className:"row",style:{width:"100%",textAlign:"center"}},r.a.createElement("div",{className:"col-sm"},r.a.createElement("h2",null,"All Conversations"),p?r.a.createElement(v,null):r.a.createElement("div",null,a.map((function(e){return r.a.createElement(g,{key:e.id,conversation:e})})))))))},j=a(37),y=a(26),x=a(47),N=a(9),S=a(27),C=function(){var e=Object(n.useState)(!0),t=Object(s.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(""),o=Object(s.a)(c,2),u=o[0],m=o[1],E=Object(n.useState)(""),f=Object(s.a)(E,2),g=f[0],p=f[1],h=Object(n.useState)(!1),b=Object(s.a)(h,2),O=b[0],w=b[1],C=Object(n.useState)(),T=Object(s.a)(C,2),k=T[0],A=T[1],F=Object(n.useState)(),R=Object(s.a)(F,2),L=R[0],I=R[1],G=Object(n.useState)(""),D=Object(s.a)(G,2),H=D[0],B=D[1],M=Object(S.e)(),P=function(e){var t,a;return i.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.preventDefault(),w(!0),!(g&&H&&L)){n.next=13;break}return(t={}).title=g,t.description=H,t.image=k,n.next=9,i.a.awrap(d(t));case 9:a=n.sent,M.push("/conversations/"+a.id),n.next=15;break;case 13:w(!1),m("The conversation needs a title, a description and an image.");case 15:case"end":return n.stop()}}))},V=function(){l(!1),M.goBack()},_=function(e,t){I(e),console.log("Accepted File",e),A(t),m()},z=function(e){I(),A(),m(e)},J=function(e,t,a){var n=new Image;n.onload=function(){t.size<5242880?a(!0,""):a(!1,"File is too large.")},n.onerror=function(){return a(!1,"File is not an image.")},n.src=e};return r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{show:a,onHide:V,animation:!1},r.a.createElement(j.a.Header,{closeButton:!0},r.a.createElement(j.a.Title,null,"Create a new conversation")),O?r.a.createElement(r.a.Fragment,null,r.a.createElement(v,null)):r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a.Body,null,u&&r.a.createElement(x.a,{className:"alert alert-danger"},u),r.a.createElement("div",{className:"postForm"},r.a.createElement(N.a,{onSubmit:P},r.a.createElement(N.a.Group,null,r.a.createElement(N.a.Label,{htmlFor:"title"},"Title for the Conversation: "),r.a.createElement(N.a.Control,{type:"text",name:"title",onChange:function(e){return p(e.target.value)}})),r.a.createElement(N.a.Group,null,r.a.createElement(N.a.Label,{htmlFor:"description"},"Description of the Conversation: "),r.a.createElement(N.a.Control,{type:"text",name:"title",onChange:function(e){return B(e.target.value)}})),r.a.createElement(N.a.Group,null,r.a.createElement(N.a.Label,{htmlFor:"image"},"Image for the Conversation: "),r.a.createElement(N.a.Control,{type:"file",name:"image",accept:"image/*",onChange:function(e){var t,a;return i.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:A(),t=e.target.files[0],(a=new FileReader).onloadend=function(){J(a.result,t,(function(e,n){e?_(t,a.result):z(n)}))},a.readAsDataURL(t);case 5:case"end":return n.stop()}}))}}),r.a.createElement(N.a.Text,null," Image size limit is 5mb ")))),k&&r.a.createElement("div",{style:{textAlign:"center"}}," Preview: ",r.a.createElement("div",null,r.a.createElement("img",{src:k,style:{maxHeight:"300px"},alt:"Preview goes here"})))),r.a.createElement(j.a.Footer,null,r.a.createElement(y.a,{variant:"secondary",onClick:V},"Close"),r.a.createElement(y.a,{variant:"primary",onClick:P},"Save Changes")))))},T=a(94),k=a.n(T),A=a(95),F=a(63),R=a(40),L=a(96),I=a(49),G=function(e){var t,a=e.setError,l=e.goToLast,c=e.propsId,o=e.socket,i=Object(n.useState)(""),u=Object(s.a)(i,2),m=u[0],E=u[1],d=Object(n.useState)(c),f=Object(s.a)(d,1)[0],g=Object(n.useState)(""),p=Object(s.a)(g,2),v=p[0],h=p[1],b=function(){return m&&v},O=function(){o.emit("POST_COMMENT",f,{name:m,text:v,date:Date.now()}),h(""),a(""),l()},w=function(){a("Comment can't be empty")};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",(t={className:"col"},Object(F.a)(t,"className","col"),Object(F.a)(t,"style",{background:"white",position:"fixed",bottom:0,width:"100%"}),t),r.a.createElement(L.a,{style:{background:"white",padding:10,position:"fixed",bottom:0,left:0,right:0,width:"100%"}},r.a.createElement(N.a,{onSubmit:function(e){return function(e){e.preventDefault(),b()?O():w()}(e)},className:"comment-form"},r.a.createElement(N.a.Row,null,r.a.createElement(N.a.Group,{as:R.a,sm:"3",style:{marginLeft:"auto",marginRight:"auto"}},r.a.createElement(N.a.Label,null,"Your Name"),r.a.createElement(I.a,null,r.a.createElement(I.a.Prepend,null,r.a.createElement(I.a.Text,null,"@")),r.a.createElement(N.a.Control,{type:"text",placeholder:"Username",value:m,onChange:function(e){return E(e.target.value)},required:!0}))),r.a.createElement(N.a.Group,{as:R.a,sm:"8",style:{marginLeft:"auto",marginRight:"auto"}},r.a.createElement(N.a.Label,null,"Your Comment"),r.a.createElement(N.a.Control,{as:"textarea",type:"text",value:v,onChange:function(e){return h(e.target.value)}}),r.a.createElement(y.a,{type:"submit"},"Send comment"))))))))},D=a(51),H=function(e){var t=e.message,a=new Date(t.date),n=a.getFullYear(),l=a.getMonth(),c=a.getDate(),o=a.getHours(),i=a.getMinutes();return i=1===i.toString().length?"0"+i.toString():i,r.a.createElement(D.a,{style:{margin:"auto",marginTop:10}},r.a.createElement(D.a.Header,{closeButton:!1},r.a.createElement("strong",{className:"mr-auto"},t.name),r.a.createElement("small",null,o+":"+i+" "+c+"/"+l+"/"+n)),r.a.createElement(D.a.Body,null,t.text))},B=function(e){var t=e.messages;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{position:"sticky",padding:10}},t.map((function(e){return r.a.createElement(H,{message:e})}))))};function M(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}var P=function(e){var t=Object(n.useState)({}),a=Object(s.a)(t,2),l=a[0],c=a[1],o=Object(A.a)([]),i=Object(s.a)(o,2),u=i[0],m=i[1],E=Object(n.useState)(e.match.params.id),d=Object(s.a)(E,1)[0],f=Object(n.useState)(""),g=Object(s.a)(f,2),p=g[0],h=g[1],b=Object(n.useState)(null),O=Object(s.a)(b,2),w=O[0],j=O[1],N=function(){var e=Object(n.useState)(M()),t=Object(s.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){function e(){r(M())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),a}(),S=N.height,C=(N.width,Object(n.useRef)(null)),T=Object(n.useRef)(null);Object(n.useEffect)((function(){var e;return w||((e=k()("https://roninchatapp.herokuapp.com/")).connect(),e.emit("JOIN_ROOM",d),e.on("SET_CONVERSATION",(function(e){console.log("SETTING CONVERSATION",e),console.log("SETTING CONVERSATION MESSAGES",e.messages),c(e),m((function(t){e.messages.map((function(e){return t.push(e)}))}))})),e.on("UPDATE_CONVERSATION",(function(e){console.log("UPDATING CONVERSATION",e),m((function(t){t.push(e)}))})),e.on("SET_ERROR",(function(e){h(e)})),j(e)),function(){e.emit("LEAVE_ROOM",d),e.disconnect()}}),[]);var F=function(e){return window.scrollTo(0,e.current.offsetTop)},R=function(){return F(C)};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"container",style:{textAlign:"left"}},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col",style:{width:"100%",margin:"auto"}},r.a.createElement("h5",{style:{width:"100%",margin:"auto"}},l.title),r.a.createElement(y.a,{onClick:R},"Go to last"),p?r.a.createElement(x.a,{variant:"danger",style:{position:"fixed",top:0,left:0,right:0}},p):null,r.a.createElement("div",{ref:T,style:{visibility:"hidden",height:"1px",float:"left",clear:"both"}}),u?r.a.createElement(B,{messages:u}):r.a.createElement(v,null),r.a.createElement("div",{ref:C,style:{visibility:"hidden",height:"1px",float:"left",clear:"both"}}),r.a.createElement(y.a,{onClick:function(){return F(T)}},"Go to top")))),r.a.createElement("div",{className:"container",style:{maxHeight:S/3.5,height:S/3.5}},r.a.createElement(G,{setError:h,goToLast:R,propsId:d,socket:w})))},V=a(50),_=a(41),z=function(){return r.a.createElement(_.a,{collapseOnSelect:!0,bg:"light",expand:"lg"},r.a.createElement(_.a.Brand,{as:f.b,href:"#",to:"/"},"Ronin ChatApp"),r.a.createElement(_.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(_.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(V.a,{className:"mr-auto"},r.a.createElement(V.a.Link,{as:f.b,href:"#","data-testid":"restaurantList-link",to:"/"},"Conversation list"),r.a.createElement(V.a.Link,{as:f.b,href:"#",to:"/newconversation"},"Create a new conversation"))))},J=function(){return r.a.createElement("div",{id:"AppWrapper",className:"App"},r.a.createElement(z,null),r.a.createElement(S.a,{exact:!0,path:"/",component:w}),r.a.createElement(S.a,{exact:!0,path:"/newConversation",component:C}),r.a.createElement(S.a,{exact:!0,path:"/conversations/:id",component:P}))};c.a.render(r.a.createElement(f.a,null,r.a.createElement(J,null)),document.getElementById("root"))},97:function(e,t,a){e.exports=a(159)}},[[97,1,2]]]);
//# sourceMappingURL=main.6db5f475.chunk.js.map